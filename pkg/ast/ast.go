//go:generate go run generate-ast-nodes.go

/*
the ast package hold the ast nodes for `temp-lang` for the ast that will be
generated by a parser, and evaluated as a program
*/
package ast

import (
	"fmt"
	"strings"
)

type Node interface {
	Literal() any
	Lexeme() string
	String() string
}

type Stmt interface {
	Node
	StmtNode() // Dummy method to make go treat Expr and Stmt differently
}

type Expr interface {
	Node
	ExprNode() // Dummy method to make go treat Expr and Stmt differently
}

type Program struct {
	Statements []Stmt
}

func (p *Program) TokenLiteral() string {
	if len(p.Statements) > 0 {
		return p.Statements[0].Lexeme()
	} else {
		return ""
	}
}

func (p *Program) String() string {
	var str strings.Builder

	for _, stmt := range p.Statements {
		str.WriteString(stmt.String())
	}

	return str.String()
}

// / =========
func (l *LetStmt) String() string {
	var str strings.Builder

	// TODO: update String when let is is fully implemented
	fmt.Fprintf(&str, "let %s = %s\n", l.Name.String(), "_EXPR_")

	return str.String()
}

func (i *IdentifierExpr) String() string {
	var str strings.Builder

	fmt.Fprintf(&str, "%s", i.Value)

	return str.String()
}
